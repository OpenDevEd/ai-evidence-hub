{%- from "kerkoapp/_attributes.html.jinja2" import title_aria_label %}
{%- from "macros/svgs.jinja2" import helpIcon %}
{%- from "macros/searchIcon.jinja2" import searchIcon %}
{%- from "macros/svgs.jinja2" import expandIcon %}

{%- if search_results %}
<div class="px-0 py-0" style="display: grid; gap: 20px" id="search-container">
    <div class="w-100 d-flex justify-content-between align-items-center">
        <div id=" search-title" class="d-flex align-items-center">
            <h1 class="h2 mb-0" id="search-title">
                {%- if is_searching %}
                {{ _("Search results") }}
                {%- else %}
                {{ _("Search") }}
                {%- endif %}
            </h1>
        </div>
        <div class="d-flex align-items-center" style="gap: 5px;" id="help-sort-btns">
            <div class="{% block help_link_wrapper_classes %}d-inline-block d-print-none{% endblock %}">
                <button class="{% block help_btn_classes %} btn-normal {% endblock %}" data-toggle="modal"
                    data-target="#search-help">
                    {{ _("Help") }}
                    {{ helpIcon('helpIcon', 20, 20) }}
                </button>
            </div>
            {%- if facet_results and search_results %}
            <div class="{% block facets_link_wrapper_classes %}d-inline-block d-lg-none d-print-none{% endblock %}">
                <button id="facets-modal-toggle" class="{% block facets_btn_classes %}btn-normal{% endblock %}">
                    <span class="fas fa-compass" aria-hidden="true"></span> {{ _("Explore") }}
                </button>
            </div>
            {%- endif %}
            <div class="d-none d-lg-flex">
                {%- if search_results %}
                {%- include "kerkoapp/_sorter.html.jinja2" %}
                {%- endif %}
            </div>
        </div>
    </div>
    <form method="post" role="search" {% block search_form_attributes %}class="form d-print-none w-100" {% endblock %}>
        <div class="w-100" style="display: grid; gap: 13px">
            <div class="">
                {{- form.hidden_tag() }}
                <div class="form-row mx-n1 d-flex">
                    {%-
                    set placeholder = _("Search within results for...")
                    if is_searching
                    else _("Search for...")
                    %}
                    {%- set keywords_validation_class = " is-invalid" if 'keywords' in form.errors else "" %}
                    {%- set scope_validation_class = " is-invalid" if 'scope' in form.errors else "" %}
                    {# <label for="{{ form.keywords.id }}" class="sr-only">{{ placeholder }}</label> #}
                    {# {{- form.keywords(class_="form-control" + keywords_validation_class, placeholder=placeholder)
                    }} #}
                    <div class="d-flex w-100" style="gap: 5px">
                        <div class="search-input-group">
                            <span class="search-icon">
                                {{ searchIcon('searchIcon mb-1', 24, 24) }}
                            </span>
                            <input maxlength="1000" name="keywords" placeholder="Search for..." type="search" value="">
                        </div>
                        {%- include "search-form/search-in-dropdown.jinja2" %}
                        {# {%- include "search-form/search-button.jinja2" %} #}

                        {# <label for="scope" class="sr-only">{{ _('Search in...') }}</label> #}
                        {# {{- form.scope(class_="search-select-filter" + scope_validation_class) }} #}
                    </div>
                </div>
                {%- if form.errors %}
                {%- for key, errors in form.errors.items() %}
                {%- for error in errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
                {%- endfor %}
                {%- endfor %}
                {%- endif %}
            </div>
        </div>
    </form>
    <div class="d-flex sort-help-container">
        <div class="w-100">
            {%- include "kerkoapp/_breadbox.html.jinja2" %}
        </div>
        {%- if is_searching or facet_results %}
        <div class="col-auto pl-0 ml-auto text-right pr-0">
            {%- if is_searching %}
            <div class="{% block reset_link_wrapper_classes %}d-inline-block d-print-none mt-0 mb-2{% endblock %}">
                <a class="{% block reset_btn_classes %}btn btn-normal{% endblock %}"
                    href="{{ url_for('kerko.search') }}">
                    <span class="fas fa-trash-alt" aria-hidden="true"></span> {{ _("Reset search") }}
                </a>
            </div>
            {%- endif %}
        </div>
        {%- endif %}
    </div>
</div>
<div class="d-lg-none d-flex">
    {%- if search_results %}
    {%- include "kerkoapp/_sorter.html.jinja2" %}
    {%- endif %}
</div>
{%- endif %}